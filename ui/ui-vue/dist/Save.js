import{_ as I,i as A,r as V,k as D,o as E,a as o,b as r,l as d,t as c,f as m,u as a,B as N,m as u,v as O,c as v,w as f,g as y,p as k,h as C,F as U,d as j,q as g,s as p,x as X,n as q,L as h,y as T}from"./index.js";const z={key:0,class:"saveload-static"},M={class:"saveload-row"},W={key:0,class:"saveload-tip"},Y={class:"saveload-list"},G=["onClick"],H={class:"saveload-list-item-label"},J={key:1,class:"saveload-static saveload-row"},w=!0,K={__name:"Save",props:{withBackground:Boolean,buttonTarget:Object},setup(b){const i=A("$game"),_=V([]),s=V(""),$=D(()=>!!_.value.find(e=>e.name===s.value));async function L(){await h.extensions.core_vehicle_partmgmt.openConfigFolderInExplorer()}async function F(e){$.value&&!await T("Are you sure?","ui.garage.save.overwrite",[{label:"Overwrite",value:!0},{label:"Cancel",value:!1}])||(await h.extensions.core_vehicle_partmgmt.saveLocal(e+".pc"),w&&i.api.engineLua(`extensions.load('util_createThumbnails'); util_createThumbnails.startWork("${e}")`))}async function S(e){await h.extensions.core_vehicle_partmgmt.loadLocal(e+".pc")}async function x(e){await T("Are you sure?","This will permanently remove the configuration. You will not be able to recover it.",[{label:"Delete permanently",value:!0},{label:"Cancel",value:!1}])&&(await h.extensions.core_vehicle_partmgmt.removeLocal(e),await l())}async function l(){const e=await h.extensions.core_vehicle_partmgmt.getConfigList();_.value=Array.isArray(e)?e:[]}return i.events.on("VehicleChange",l),i.events.on("VehicleFocusChanged",l),i.events.on("VehicleconfigSaved",l),E(()=>{i.events.off("VehicleChange",l),i.events.off("VehicleFocusChanged",l),i.events.off("VehicleconfigSaved",l)}),l(),(e,n)=>(o(),r("div",{class:q({saveload:!0,"with-background":b.withBackground})},[_.value?(o(),r("div",z,[d("div",M,[d("span",null,c(e.$t("ui.vehicleconfig.filename")),1),m(a(N),{modelValue:s.value,"onUpdate:modelValue":n[0]||(n[0]=t=>s.value=t)},null,8,["modelValue"]),u((o(),v(a(k),{accent:$.value?"attention":"main",onClick:n[1]||(n[1]=t=>F(s.value))},{default:f(()=>[y(c($.value?e.$t("ui.common.overwrite"):e.$t("ui.common.save")),1)]),_:1},8,["accent"])),[[a(O),!s.value]])]),s.value?(o(),r("div",W,[d("p",null,c(e.$t("ui.vehicleconfig.mouseOverUi")),1)])):C("",!0)])):C("",!0),d("div",Y,[(o(!0),r(U,null,j(_.value,t=>(o(),r("div",{class:"saveload-list-item",onClick:B=>s.value=t.name,tabindex:"1"},[t.official?u((o(),v(a(p),{key:0,glyph:"\u{BEA01}"},null,512)),[[a(g),e.$t("ui.vehicleconfig.sourceOfficial"),"top"]]):t.player?u((o(),v(a(p),{key:1,glyph:"\u{BEAC4}"},null,512)),[[a(g),e.$t("ui.vehicleconfig.sourceUser"),"top"]]):u((o(),v(a(p),{key:2,glyph:"\u{BEAD7}"},null,512)),[[a(g),e.$t("ui.vehicleconfig.sourceMod"),"top"]]),d("div",H,c(t.name),1),u((o(),v(a(k),{accent:"outlined",Xicon:"folder_open",onClick:B=>S(t.name)},{default:f(()=>[m(a(p),{glyph:"\u{BEA1A}"}),y(" "+c(e.$t("ui.vehicleconfig.load")),1)]),_:2},1032,["onClick"])),[[a(g),e.$t("ui.vehicleconfig.loadTooltip"),"top"]]),t.player?u((o(),v(a(k),{key:3,class:"saveload-list-item-delete",accent:"outlined",Xicon:"delete_forever",onClick:B=>x(t.name)},{default:f(()=>[m(a(p),{glyph:"\u{BEB29}",color:"#f00"})]),_:2},1032,["onClick"])),[[a(g),e.$t("ui.vehicleconfig.deleteTooltip"),"top"]]):C("",!0)],8,G))),256))]),b.buttonTarget?C("",!0):(o(),r("div",J,[m(a(X),{checked:w,onClick:n[2]||(n[2]=t=>w=!w)},{default:f(()=>[y(c(e.$t("ui.vehicleconfig.saveThumbnail")),1)]),_:1}),m(a(k),{accent:"main",onClick:n[3]||(n[3]=t=>L())},{default:f(()=>[y(c(e.$t("ui.vehicleconfig.openConfigFolder")),1)]),_:1})]))],2))}};var Q=I(K,[["__scopeId","data-v-1143b00a"]]);export{Q as default};
